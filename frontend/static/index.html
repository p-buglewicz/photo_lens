<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LensAnalytics Ingestion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              base: "#0a1826",
              card: "#0f2536",
              accent: "#1ad1a5",
              accentStrong: "#12b48c",
              muted: "#9fb3c8",
              text: "#eaf4ff",
              border: "#143047",
              error: "#ff6b6b",
            },
            fontFamily: {
              sans: ["Manrope", "Inter", "system-ui", "sans-serif"],
            },
            boxShadow: {
              glow: "0 25px 80px rgba(0,0,0,0.35)",
              button: "0 12px 30px rgba(26,209,165,0.35)",
            },
          },
        },
      };
    </script>
    <style>
      @keyframes float-in {
        from {
          transform: translateY(6px);
          opacity: 0;
        }

        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .file-fade-enter-active {
        transition: all 0.3s ease-out;
      }

      .file-fade-leave-active {
        transition: all 0.5s ease-in;
      }

      .file-fade-enter-from {
        opacity: 0;
        transform: translateY(-10px);
      }

      .file-fade-leave-to {
        opacity: 0;
        transform: translateY(10px);
      }
    </style>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  </head>

  <body
    class="min-h-screen font-sans text-text bg-[radial-gradient(circle_at_15%_20%,rgba(26,209,165,0.1),transparent_25%),radial-gradient(circle_at_85%_10%,rgba(32,125,255,0.12),transparent_28%),linear-gradient(135deg,#07111b_0%,#0a1a2b_50%,#0d2234_100%)] flex items-center justify-center p-6 relative overflow-hidden"
  >
    <div class="absolute inset-0 pointer-events-none">
      <div class="absolute -left-10 top-8 h-40 w-40 rounded-full bg-accent/15 blur-3xl"></div>
      <div class="absolute -right-20 -top-10 h-56 w-56 rounded-full bg-blue-400/20 blur-3xl"></div>
    </div>
    <div id="app" class="w-full max-w-xl relative z-10">
      <div
        class="bg-card/90 border border-border rounded-2xl shadow-glow p-6 backdrop-blur-md animate-[float-in_420ms_ease-out]"
      >
        <div
          class="inline-flex items-center gap-2 text-sm font-semibold uppercase tracking-[0.08em] text-accent bg-accent/10 border border-accent/25 rounded-full px-3 py-1"
        >
          <span class="h-2 w-2 rounded-full bg-accent"></span>
          LensAnalytics
        </div>
        <h1 class="mt-3 mb-2 text-2xl font-semibold tracking-tight text-text">
          Ingest Google Takeout
        </h1>
        <p class="mb-5 text-muted leading-relaxed">
          Start the ingestion worker and watch its progress in real time.
        </p>

        <div class="bg-white/5 border border-border rounded-xl p-4 mb-5">
          <div>
            <h2 class="font-semibold text-text">Ingestion settings</h2>
            <p class="text-sm text-muted">Configure defaults before starting ingestion.</p>
          </div>

          <div class="mt-4 space-y-3">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <label class="block">
                <span class="text-sm text-muted">Limit (0 = all)</span>
                <input
                  type="number"
                  min="0"
                  class="mt-1 w-full rounded-lg border border-border bg-slate-900/60 px-3 py-2 text-sm text-text placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-accent/60"
                  placeholder="0"
                  v-model.number="ingestConfig.limit"
                />
              </label>
              <label class="flex items-center gap-3 pt-5 text-sm text-text">
                <input
                  type="checkbox"
                  class="h-4 w-4 rounded border-border text-accent focus:ring-accent/60"
                  v-model="ingestConfig.reprocess"
                />
                <span>Reprocess existing records</span>
              </label>
            </div>
          </div>
        </div>

        <div class="flex flex-col gap-3 sm:flex-row sm:items-center">
          <button
            class="bg-gradient-to-r from-accent to-accentStrong text-slate-950 font-semibold rounded-xl px-4 py-3 shadow-button transition duration-150 ease-out hover:-translate-y-0.5 hover:shadow-[0_14px_36px_rgba(26,209,165,0.38)] disabled:opacity-70 disabled:cursor-not-allowed disabled:shadow-none"
            :disabled="loading"
            @click="startIngestion"
          >
            {{ loading ? "Starting..." : "Start ingestion" }}
          </button>
          <div
            class="flex-1 text-sm text-muted border border-border rounded-xl px-3 py-2 bg-white/5"
            v-if="batchId"
          >
            Batch {{ batchId }}
          </div>
        </div>

        <div class="flex items-center justify-between mt-5 mb-2">
          <span class="text-muted font-semibold tracking-wide text-sm">Status</span>
          <span class="font-bold capitalize">{{ statusText }}</span>
        </div>

        <div class="bg-white/5 border border-border rounded-xl p-4">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-muted">Files processed</span>
            <span class="text-2xl font-bold text-accent">{{ processed }}</span>
          </div>

          <div v-if="recentFiles.length > 0" class="space-y-1 max-h-32 overflow-hidden">
            <div class="text-xs text-muted mb-1">Recent files:</div>
            <transition-group name="file-fade">
              <div
                v-for="file in recentFiles.slice(0, 5)"
                :key="file.timestamp"
                class="text-xs text-slate-300 truncate px-2 py-1 bg-white/5 rounded"
              >
                {{ file.name }}
              </div>
            </transition-group>
          </div>
        </div>

        <div
          class="mt-4 text-sm border border-border rounded-xl px-3 py-2 bg-white/5 text-slate-200"
          v-if="info"
        >
          {{ info }}
        </div>
        <div
          class="mt-3 text-sm border border-error/60 rounded-xl px-3 py-2 bg-error/10 text-error"
          v-if="error"
        >
          {{ error }}
        </div>
      </div>
    </div>

    <script type="module" src="./app.js"></script>
  </body>
</html>
